schema: '2.0'
stages:
  prepare_emails:
    cmd: bash src/prepare_emails.sh
    deps:
    - path: code/convert_to_parquet.py
      hash: md5
      md5: a8fa47031ad7d03d77378c57abbf0a72
      size: 4652
    outs:
    - path: data/enron_emails.parquet
      hash: md5
      md5: e32b0855968545645da7d1fd57d32ba7
      size: 598003929
  report:
    cmd: bash -c "cd report && latexmk article.tex -pdf"
    deps:
    - path: report/article.tex
      hash: md5
      md5: ddea5843be57f91a64352fa37ce9e402
      size: 2553
    outs:
    - path: report/article.pdf
      hash: md5
      md5: a85c6b0dbc2336e2269b4757289566b1
      size: 74983
  scrape_convictions:
    cmd: python code/scrape_conviction_data.py --output data/convictions.csv
    deps:
    - path: code/scrape_conviction_data.py
      hash: md5
      md5: de00ddfdb649a1ddb83b665e648d6a8e
      size: 3922
    outs:
    - path: data/convictions.csv
      hash: md5
      md5: db9b823991c86d5c98c2a6ab30e8fd78
      size: 5517
  parse_messages:
    cmd: python code/parse_messages.py --emails_file data/enron_emails.parquet --person_yaml
      data/person_info.yaml --output_dir data
    deps:
    - path: code/parse_messages.py
      hash: md5
      md5: 557414a03ac901fe8072e740aa17d016
      size: 10884
    - path: data/enron_emails.parquet
      hash: md5
      md5: e32b0855968545645da7d1fd57d32ba7
      size: 598003929
    - path: data/person_info.yaml
      hash: md5
      md5: edb3847eda1bc5aad5a96915aad393e7
      size: 2193
    outs:
    - path: data/exec_emails.csv
      hash: md5
      md5: 73882d3d8daa266eddf749b844088f97
      size: 44433937
    - path: data/norm_emails.csv
      hash: md5
      md5: 812877ed37ac67ffc118c3163a1c439b
      size: 62324341
    - path: data/poi_emails.csv
      hash: md5
      md5: 9f58237e685daa9e36e56342717c5407
      size: 3513568
  mask_datasets:
    cmd: python code/mask_datasets.py
    deps:
    - path: code/mask_datasets.py
      hash: md5
      md5: 756cc21fcf62c807ecf95d107d501b15
      size: 3842
    - path: data/exec_emails.csv
      hash: md5
      md5: 73882d3d8daa266eddf749b844088f97
      size: 44433937
    - path: data/norm_emails.csv
      hash: md5
      md5: 812877ed37ac67ffc118c3163a1c439b
      size: 62324341
    - path: data/poi_emails.csv
      hash: md5
      md5: 9f58237e685daa9e36e56342717c5407
      size: 3513568
    outs:
    - path: data/exec_masked_emails.csv
      hash: md5
      md5: 358b8974c11d7e5f2bb97f2377dc55dd
      size: 90566371
    - path: data/norm_masked_emails.csv
      hash: md5
      md5: 914dac8b552ae1e81ee779884df30764
      size: 181420716
    - path: data/poi_masked_emails.csv
      hash: md5
      md5: 1771119fac38a3d912218f326db7b480
      size: 6546914
  dataset_splitting:
    cmd: python code/dataset_splitting.py --poi_file data/poi_masked_emails.csv --exec_file
      data/exec_masked_emails.csv --norm_file data/norm_masked_emails.csv --output_dir
      data
    deps:
    - path: code/dataset_splitting.py
      hash: md5
      md5: 548c597ac5efca710a3c5226c1d6d6b3
      size: 3975
    - path: data/exec_masked_emails.csv
      hash: md5
      md5: 358b8974c11d7e5f2bb97f2377dc55dd
      size: 90566371
    - path: data/norm_masked_emails.csv
      hash: md5
      md5: 914dac8b552ae1e81ee779884df30764
      size: 181420716
    - path: data/poi_masked_emails.csv
      hash: md5
      md5: 1771119fac38a3d912218f326db7b480
      size: 6546914
    outs:
    - path: data/test_set.csv
      hash: md5
      md5: fcfba5aed1abcaa858663c0878aed622
      size: 7959195
    - path: data/train_set.csv
      hash: md5
      md5: ba9ac61a300c043a77ad22f52eb05959
      size: 80312238
    - path: data/valid_set.csv
      hash: md5
      md5: 2988329f4cb6ea5514892266931fb93c
      size: 5014712
  modelling:
    cmd: mkdir -p data/model_runs && python code/modelling.py --train_file data/train_set.csv
      --valid_file data/valid_set.csv --test_file data/test_set.csv
    deps:
    - path: code/modelling.py
      hash: md5
      md5: f972d419619194e5121e3e428c30088f
      size: 16438
    - path: data/test_set.csv
      hash: md5
      md5: fcfba5aed1abcaa858663c0878aed622
      size: 7959195
    - path: data/train_set.csv
      hash: md5
      md5: ba9ac61a300c043a77ad22f52eb05959
      size: 80312238
    - path: data/valid_set.csv
      hash: md5
      md5: 2988329f4cb6ea5514892266931fb93c
      size: 5014712
    outs:
    - path: data/best_model_data.csv
      hash: md5
      md5: c3d7adec074ac1f860b8cf466ea57413
      size: 389
    - path: data/experiment_data.csv
      hash: md5
      md5: bc1b6346bf8fd177509ddd4c513e3f8f
      size: 3963
    - path: data/model_runs
      hash: md5
      md5: 9ea236a18e65e6e0839fc5907325d112.dir
      size: 262236960
      nfiles: 72
    - path: data/token_coeffs.csv
      hash: md5
      md5: 984e454218a4d93e4abb2705baed4869
      size: 2644153
